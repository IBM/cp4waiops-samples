{"version":3,"file":"IncidentListWidget.js","names":["Renderer","constructor","options","content","iframeId","getId","containerId","getContainer","canvas","features","on","payload","contentID","info","events","contentId","document","getElementById","parentNode","id","dataPointSelection","getContent","getFeature","inputColumnMapping","getPropertyList","forEach","item","getPropertyValue","getColumnMapping","value","JSON","parse","ex","iframeIncidentListWidget","contentWindow","postMessage","source","params","widgetdata","getSelections","transformations","columnmapping","data","name","viewName","viewname","window","location","origin","showToolbar","showtoolbar","showDetails","showdetails","columnMapping","getAPI","render","domNode","destroy","renderControl","replace","innerHTML","host","parent","Promise","resolve","_default","_exports","default"],"sources":["../../ext/incident-list/IncidentListWidget.js"],"sourcesContent":["/* ******************************************************** {COPYRIGHT-TOP} ****\n * IBM Confidential\n * 5725-Q09, 5737-M96\n * Â© Copyright IBM Corp. 2024\n ********************************************************* {COPYRIGHT-END} ****/\nclass Renderer {\n  constructor(options) {\n    this.content = options.content;\n    this.iframeId = `${this.content.getId()}_incidentListWidget`;\n    this.containerId = this.content.getContainer().getId();\n    this.canvas = options.features['Dashboard.Canvas'];\n\n    this.canvas.on('change:content:selections', (payload) => {\n      const contentID = payload.info.events[0].info.contentId;\n      const containerId = document.getElementById(contentID).parentNode.id;\n      const dataPointSelection = this.canvas\n        .getContent(contentID)\n        .getFeature('DataPointSelections');\n      let inputColumnMapping;\n      this.content.getPropertyList().forEach((item) => {\n        if (item.id === 'inputColumnMapping') {\n          inputColumnMapping = item.getPropertyValue();\n        }\n      });\n\n      const getColumnMapping = (value) => {\n        try {\n          return JSON.parse(value);\n        } catch (ex) {\n          return value;\n        }\n      };\n\n      if (containerId === this.containerId) {\n        inputColumnMapping = getColumnMapping(inputColumnMapping);\n        const iframeIncidentListWidget = document.getElementById(this.iframeId);\n        iframeIncidentListWidget?.contentWindow.postMessage(\n          {\n            source: 'dashboard',\n            params: {\n              widgetdata: dataPointSelection.getSelections(),\n              transformations: { columnmapping: inputColumnMapping }\n            }\n          },\n          '*'\n        );\n      }\n    });\n\n    this.content.on('change:property', (data) => {\n      const iframeIncidentListWidget = document.getElementById(this.iframeId);\n\n      if (data?.info?.events[0].name === 'change:property:dropdownView') {\n        const viewName = data?.info?.events[0].info.value;\n        iframeIncidentListWidget.contentWindow.postMessage({ source: 'dashboard', params: { viewname: viewName } }, window.location.origin);\n      }\n\n      if (data?.info?.events[0].name === 'change:property:toggleToolbar') {\n        const showToolbar = data?.info?.events[0].info.value;\n        iframeIncidentListWidget.contentWindow.postMessage({ source: 'dashboard', params: { showtoolbar: showToolbar } }, window.location.origin);\n      }\n\n      if (data?.info?.events[0].name === 'change:property:toggleDetails') {\n        const showDetails = data?.info?.events[0].info.value;\n        iframeIncidentListWidget.contentWindow.postMessage({ source: 'dashboard', params: { showdetails: showDetails } }, window.location.origin);\n      }\n\n      if (data?.info?.events[0].name === 'change:property:inputColumnMapping') {\n        let columnMapping = data?.info?.events[0].info.value;\n\n        const getColumnMapping = (value) => {\n          try {\n            return JSON.parse(value);\n          } catch (ex) {\n            return value;\n          }\n        };\n\n        columnMapping = getColumnMapping(columnMapping);\n        iframeIncidentListWidget.contentWindow.postMessage(\n          {\n            source: 'dashboard',\n            params: { transformations: { columnmapping: { columnMapping } } }\n          },\n          window.location.origin\n        );\n      }\n    });\n  }\n\n  getAPI() {\n    return {\n      render: (domNode) => this.render(domNode)\n    };\n  }\n\n  destroy() {}\n\n  renderControl() {\n    let viewName = '';\n    let showToolbar = true;\n    let showDetails = false;\n\n    this.content.getPropertyList().forEach((item) => {\n      if (typeof item.getPropertyValue() !== 'undefined' && item.id === 'dropdownView') {\n        viewName = item.getPropertyValue();\n        viewName = viewName.replace(/ /g, '+');\n      } else if (typeof item.getPropertyValue() !== 'undefined' && item.id === 'toggleToolbar') {\n        showToolbar = item.getPropertyValue();\n      } else if (typeof item.getPropertyValue() !== 'undefined' && item.id === 'toggleDetails') {\n        showDetails = item.getPropertyValue();\n      }\n    });\n\n    this.parentNode.innerHTML = \"<iframe id='\" + this.iframeId + \"' src='https://\" + window.location.host + '/aiops/default/widgets/incidents?showtoolbar=' +\n      showToolbar +\n      '&showdetails=' +\n      showDetails +\n      '&viewname=' +\n      viewName +\n      '&containerid=' +\n      this.containerId +\n      \"' title='AIOPS Incident List widget' frameBorder='0' width='100%' height='100%'></iframe>\";\n  }\n\n  render(options) {\n    this.parentNode = options.parent;\n    this.renderControl();\n    return Promise.resolve();\n  }\n}\n\nexport default Renderer;\n"],"mappings":";;;;;;;EAAA;AACA;AACA;AACA;AACA;EACA,MAAMA,QAAQ,CAAC;IACbC,WAAWA,CAACC,OAAO,EAAE;MACnB,IAAI,CAACC,OAAO,GAAGD,OAAO,CAACC,OAAO;MAC9B,IAAI,CAACC,QAAQ,GAAI,GAAE,IAAI,CAACD,OAAO,CAACE,KAAK,CAAC,CAAE,qBAAoB;MAC5D,IAAI,CAACC,WAAW,GAAG,IAAI,CAACH,OAAO,CAACI,YAAY,CAAC,CAAC,CAACF,KAAK,CAAC,CAAC;MACtD,IAAI,CAACG,MAAM,GAAGN,OAAO,CAACO,QAAQ,CAAC,kBAAkB,CAAC;MAElD,IAAI,CAACD,MAAM,CAACE,EAAE,CAAC,2BAA2B,EAAGC,OAAO,IAAK;QACvD,MAAMC,SAAS,GAAGD,OAAO,CAACE,IAAI,CAACC,MAAM,CAAC,CAAC,CAAC,CAACD,IAAI,CAACE,SAAS;QACvD,MAAMT,WAAW,GAAGU,QAAQ,CAACC,cAAc,CAACL,SAAS,CAAC,CAACM,UAAU,CAACC,EAAE;QACpE,MAAMC,kBAAkB,GAAG,IAAI,CAACZ,MAAM,CACnCa,UAAU,CAACT,SAAS,CAAC,CACrBU,UAAU,CAAC,qBAAqB,CAAC;QACpC,IAAIC,kBAAkB;QACtB,IAAI,CAACpB,OAAO,CAACqB,eAAe,CAAC,CAAC,CAACC,OAAO,CAAEC,IAAI,IAAK;UAC/C,IAAIA,IAAI,CAACP,EAAE,KAAK,oBAAoB,EAAE;YACpCI,kBAAkB,GAAGG,IAAI,CAACC,gBAAgB,CAAC,CAAC;UAC9C;QACF,CAAC,CAAC;QAEF,MAAMC,gBAAgB,GAAIC,KAAK,IAAK;UAClC,IAAI;YACF,OAAOC,IAAI,CAACC,KAAK,CAACF,KAAK,CAAC;UAC1B,CAAC,CAAC,OAAOG,EAAE,EAAE;YACX,OAAOH,KAAK;UACd;QACF,CAAC;QAED,IAAIvB,WAAW,KAAK,IAAI,CAACA,WAAW,EAAE;UACpCiB,kBAAkB,GAAGK,gBAAgB,CAACL,kBAAkB,CAAC;UACzD,MAAMU,wBAAwB,GAAGjB,QAAQ,CAACC,cAAc,CAAC,IAAI,CAACb,QAAQ,CAAC;UACvE6B,wBAAwB,EAAEC,aAAa,CAACC,WAAW,CACjD;YACEC,MAAM,EAAE,WAAW;YACnBC,MAAM,EAAE;cACNC,UAAU,EAAElB,kBAAkB,CAACmB,aAAa,CAAC,CAAC;cAC9CC,eAAe,EAAE;gBAAEC,aAAa,EAAElB;cAAmB;YACvD;UACF,CAAC,EACD,GACF,CAAC;QACH;MACF,CAAC,CAAC;MAEF,IAAI,CAACpB,OAAO,CAACO,EAAE,CAAC,iBAAiB,EAAGgC,IAAI,IAAK;QAC3C,MAAMT,wBAAwB,GAAGjB,QAAQ,CAACC,cAAc,CAAC,IAAI,CAACb,QAAQ,CAAC;QAEvE,IAAIsC,IAAI,EAAE7B,IAAI,EAAEC,MAAM,CAAC,CAAC,CAAC,CAAC6B,IAAI,KAAK,8BAA8B,EAAE;UACjE,MAAMC,QAAQ,GAAGF,IAAI,EAAE7B,IAAI,EAAEC,MAAM,CAAC,CAAC,CAAC,CAACD,IAAI,CAACgB,KAAK;UACjDI,wBAAwB,CAACC,aAAa,CAACC,WAAW,CAAC;YAAEC,MAAM,EAAE,WAAW;YAAEC,MAAM,EAAE;cAAEQ,QAAQ,EAAED;YAAS;UAAE,CAAC,EAAEE,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC;QACrI;QAEA,IAAIN,IAAI,EAAE7B,IAAI,EAAEC,MAAM,CAAC,CAAC,CAAC,CAAC6B,IAAI,KAAK,+BAA+B,EAAE;UAClE,MAAMM,WAAW,GAAGP,IAAI,EAAE7B,IAAI,EAAEC,MAAM,CAAC,CAAC,CAAC,CAACD,IAAI,CAACgB,KAAK;UACpDI,wBAAwB,CAACC,aAAa,CAACC,WAAW,CAAC;YAAEC,MAAM,EAAE,WAAW;YAAEC,MAAM,EAAE;cAAEa,WAAW,EAAED;YAAY;UAAE,CAAC,EAAEH,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC;QAC3I;QAEA,IAAIN,IAAI,EAAE7B,IAAI,EAAEC,MAAM,CAAC,CAAC,CAAC,CAAC6B,IAAI,KAAK,+BAA+B,EAAE;UAClE,MAAMQ,WAAW,GAAGT,IAAI,EAAE7B,IAAI,EAAEC,MAAM,CAAC,CAAC,CAAC,CAACD,IAAI,CAACgB,KAAK;UACpDI,wBAAwB,CAACC,aAAa,CAACC,WAAW,CAAC;YAAEC,MAAM,EAAE,WAAW;YAAEC,MAAM,EAAE;cAAEe,WAAW,EAAED;YAAY;UAAE,CAAC,EAAEL,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC;QAC3I;QAEA,IAAIN,IAAI,EAAE7B,IAAI,EAAEC,MAAM,CAAC,CAAC,CAAC,CAAC6B,IAAI,KAAK,oCAAoC,EAAE;UACvE,IAAIU,aAAa,GAAGX,IAAI,EAAE7B,IAAI,EAAEC,MAAM,CAAC,CAAC,CAAC,CAACD,IAAI,CAACgB,KAAK;UAEpD,MAAMD,gBAAgB,GAAIC,KAAK,IAAK;YAClC,IAAI;cACF,OAAOC,IAAI,CAACC,KAAK,CAACF,KAAK,CAAC;YAC1B,CAAC,CAAC,OAAOG,EAAE,EAAE;cACX,OAAOH,KAAK;YACd;UACF,CAAC;UAEDwB,aAAa,GAAGzB,gBAAgB,CAACyB,aAAa,CAAC;UAC/CpB,wBAAwB,CAACC,aAAa,CAACC,WAAW,CAChD;YACEC,MAAM,EAAE,WAAW;YACnBC,MAAM,EAAE;cAAEG,eAAe,EAAE;gBAAEC,aAAa,EAAE;kBAAEY;gBAAc;cAAE;YAAE;UAClE,CAAC,EACDP,MAAM,CAACC,QAAQ,CAACC,MAClB,CAAC;QACH;MACF,CAAC,CAAC;IACJ;IAEAM,MAAMA,CAAA,EAAG;MACP,OAAO;QACLC,MAAM,EAAGC,OAAO,IAAK,IAAI,CAACD,MAAM,CAACC,OAAO;MAC1C,CAAC;IACH;IAEAC,OAAOA,CAAA,EAAG,CAAC;IAEXC,aAAaA,CAAA,EAAG;MACd,IAAId,QAAQ,GAAG,EAAE;MACjB,IAAIK,WAAW,GAAG,IAAI;MACtB,IAAIE,WAAW,GAAG,KAAK;MAEvB,IAAI,CAAChD,OAAO,CAACqB,eAAe,CAAC,CAAC,CAACC,OAAO,CAAEC,IAAI,IAAK;QAC/C,IAAI,OAAOA,IAAI,CAACC,gBAAgB,CAAC,CAAC,KAAK,WAAW,IAAID,IAAI,CAACP,EAAE,KAAK,cAAc,EAAE;UAChFyB,QAAQ,GAAGlB,IAAI,CAACC,gBAAgB,CAAC,CAAC;UAClCiB,QAAQ,GAAGA,QAAQ,CAACe,OAAO,CAAC,IAAI,EAAE,GAAG,CAAC;QACxC,CAAC,MAAM,IAAI,OAAOjC,IAAI,CAACC,gBAAgB,CAAC,CAAC,KAAK,WAAW,IAAID,IAAI,CAACP,EAAE,KAAK,eAAe,EAAE;UACxF8B,WAAW,GAAGvB,IAAI,CAACC,gBAAgB,CAAC,CAAC;QACvC,CAAC,MAAM,IAAI,OAAOD,IAAI,CAACC,gBAAgB,CAAC,CAAC,KAAK,WAAW,IAAID,IAAI,CAACP,EAAE,KAAK,eAAe,EAAE;UACxFgC,WAAW,GAAGzB,IAAI,CAACC,gBAAgB,CAAC,CAAC;QACvC;MACF,CAAC,CAAC;MAEF,IAAI,CAACT,UAAU,CAAC0C,SAAS,GAAG,cAAc,GAAG,IAAI,CAACxD,QAAQ,GAAG,iBAAiB,GAAG0C,MAAM,CAACC,QAAQ,CAACc,IAAI,GAAG,+CAA+C,GACrJZ,WAAW,GACX,eAAe,GACfE,WAAW,GACX,YAAY,GACZP,QAAQ,GACR,eAAe,GACf,IAAI,CAACtC,WAAW,GAChB,2FAA2F;IAC/F;IAEAiD,MAAMA,CAACrD,OAAO,EAAE;MACd,IAAI,CAACgB,UAAU,GAAGhB,OAAO,CAAC4D,MAAM;MAChC,IAAI,CAACJ,aAAa,CAAC,CAAC;MACpB,OAAOK,OAAO,CAACC,OAAO,CAAC,CAAC;IAC1B;EACF;EAAC,IAAAC,QAAA,GAAAC,QAAA,CAAAC,OAAA,GAEcnE,QAAQ;AAAA","ignoreList":[]}