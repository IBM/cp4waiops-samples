{"version":3,"file":"TopologyViewerWidget.js","names":["Renderer","constructor","options","content","iframeId","getId","containerId","getContainer","canvas","features","on","payload","contentID","info","events","contentId","document","getElementById","parentNode","id","dataPointSelection","getContent","getFeature","iframeTopoWidget","contentWindow","postMessage","params","widgetdata","getSelections","messageHandler","data","name","hops","value","maxResourceIds","showToolbar","hideToolbar","showSearch","hideSearch","resourceId","transformations","statusId","window","addEventListener","getAPI","render","domNode","destroy","removeEventListener","renderControl","innerHTML","location","host","parent","Promise","resolve","_default","_exports","default"],"sources":["../../ext/topology-viewer/TopologyViewerWidget.js"],"sourcesContent":["/* ******************************************************** {COPYRIGHT-TOP} ****\n * IBM Confidential\n * 5725-Q09, 5737-M96\n * Â© Copyright IBM Corp. 2023, 2024\n ********************************************************* {COPYRIGHT-END} ****/\nclass Renderer {\n  constructor(options) {\n    this.content = options.content;\n    this.iframeId = `${this.content.getId()}_topologyWidget`;\n    this.containerId = this.content.getContainer().getId();\n    this.canvas = options.features['Dashboard.Canvas'];\n\n    this.canvas.on('change:content:selections', (payload) => {\n      const contentID = payload.info.events[0].info.contentId;\n      const containerId = document.getElementById(contentID).parentNode.id;\n      const dataPointSelection = this.canvas.getContent(contentID).getFeature('DataPointSelections');\n\n      if (containerId === this.containerId) {\n        const iframeTopoWidget = document.getElementById(this.iframeId);\n        iframeTopoWidget.contentWindow.postMessage({'source': 'dashboard', params: { widgetdata: dataPointSelection.getSelections() }}, '*');\n      }\n    });\n\n    this.messageHandler = ({data}) => {\n      if (data.containerId === this.containerId) {\n        document.getElementById(this.iframeId).contentWindow.postMessage(data, '*');\n      }\n    };\n\n    this.content.on('change:property', (data) => {\n      const iframeTopoWidget = document.getElementById(this.iframeId);\n\n      if (data?.info?.events[0].name === 'change:property:hops') {\n        const hops = data?.info?.events[0].info.value;\n        iframeTopoWidget.contentWindow.postMessage({'source': 'dashboard', params: { hops: hops }}, '*');\n      }\n\n      if (data?.info?.events[0].name === 'change:property:maxResourceIds') {\n        const maxResourceIds = data?.info?.events[0].info.value;\n        iframeTopoWidget.contentWindow.postMessage({'source': 'dashboard', params: { maxResourceIds: maxResourceIds }}, '*');\n      }\n\n      if (data?.info?.events[0].name === 'change:property:toggleToolbar') {\n        const showToolbar = data?.info?.events[0].info.value;\n        iframeTopoWidget.contentWindow.postMessage({'source': 'dashboard', params: { hideToolbar: !showToolbar }}, '*');\n      }\n\n      if (data?.info?.events[0].name === 'change:property:toggleSearch') {\n        const showSearch = data?.info?.events[0].info.value;\n        iframeTopoWidget.contentWindow.postMessage({'source': 'dashboard', params: { hideSearch: !showSearch }}, '*');\n      }\n\n      if (data?.info?.events[0].name === 'change:property:resourceId') {\n        const resourceId = data?.info?.events[0].info.value;\n        iframeTopoWidget.contentWindow.postMessage({'source': 'dashboard', params: { transformations: {resourceId: resourceId} }}, '*');\n      }\n\n      if (data?.info?.events[0].name === 'change:property:statusId') {\n        const statusId = data?.info?.events[0].info.value;\n        iframeTopoWidget.contentWindow.postMessage({'source': 'dashboard', params: { transformations: {statusId: statusId}  }}, '*');\n      }\n\n      // this.renderControl();\n    });\n\n    window.addEventListener('message', this.messageHandler, false);\n  }\n\n  getAPI() {\n    return {\n      render: (domNode) => this.render(domNode)\n    };\n  }\n\n  destroy() {\n    window.removeEventListener('message', this.messageHandler, false);\n  }\n\n  renderControl() {\n    this.parentNode.innerHTML =\n      \"<iframe id='\" + this.iframeId + \"' src='https://\" + window.location.host + '/aiops/cfd95b7e-3bc7-4006-a4a8-a73a79c71255/widgets/topology-viewer?containerid=' + this.containerId + \"' frameBorder='0' title='AIOPS Topology widget' width='100%' height='100%'></iframe>\";\n  }\n\n  render(options) {\n    this.parentNode = options.parent;\n    this.renderControl();\n    return Promise.resolve();\n  }\n}\n\nexport default Renderer;\n"],"mappings":"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","ignoreList":[]}